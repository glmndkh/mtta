/tournament/:id/form-team –±–æ–ª–æ–Ω /tournament/:id/form-pair —Ö—É—É–¥–∞—Å –¥—ç—ç—Ä:

–ó”©–≤—Ö”©–Ω —Ç—É—Ö–∞–π–Ω —Ç”©—Ä”©–ª–¥ –±“Ø—Ä—Ç–≥“Ø“Ø–ª—Å—ç–Ω —Ç–æ–≥–ª–æ–≥—á–¥—ã–≥ –ª —Å–æ–Ω–≥–æ—Ö

–•—ç—Ä—ç–≥–ª—ç–≥—á ”©”©—Ä–∏–π–≥”©”© list-–¥ —Ö–∞—Ä—É—É–ª–∞—Ö–≥“Ø–π

–°–æ–Ω–≥–æ—Å–æ–Ω —Ç–æ–≥–ª–æ–≥—á–¥—ã–≥ —É—Å—Ç–≥–∞—Ö, —Å–æ–ª–∏—Ö –±–æ–ª–æ–º–∂—Ç–æ–π

–ë–∞–≥–∏–π–Ω –≥–∏—à“Ø“Ø–¥–∏–π–Ω —Ç–æ–æ –∑”©–≤ —Ö—è–∑–≥–∞–∞—Ä—Ç –±–∞–π—Ö (team ‚Üí 3‚Äì4, pair ‚Üí —è–≥ 2)

API —Ä—É—É –∏–ª–≥—ç—ç—Ö—ç–¥ –±“Ø—Ö –≥–∏—à“Ø“Ø–¥ —Ç—É—Ö–∞–π–Ω —Ç”©—Ä”©–ª–¥ –±“Ø—Ä—Ç–≥—ç–≥–¥—Å—ç–Ω –±–∞–π—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞ –±–∏–µ–ª–¥—ç–≥ –±–∞–π—Ö

üß© Backend logic update (API —à–∞–ª–≥–∞–ª—Ç –∑”©–≤ –±–æ–ª–≥–æ—Ö)

Target endpoints:

POST /api/teams

POST /api/pairs

–®–∞–∞—Ä–¥–ª–∞–≥—É—É–¥:

Server —Ç–∞–ª–¥ team/pair “Ø“Ø—Å–≥—ç—Ö “Ø–µ–¥:

–¢—É—Ö–∞–π–Ω tournamentId, category (eventType)-–≥ —à–∞–ª–≥–∞—Ö.

–ì–∏—à“Ø“Ø–Ω –±“Ø—Ä–∏–π–Ω /api/registrations –¥–æ—Ç–æ—Ä category –æ—Ä—Å–æ–Ω —ç—Å—ç—Ö–∏–π–≥ –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö.

–•—ç—Ä–≤—ç—ç ”©”©—Ä —Ç”©—Ä”©–ª–¥ –±“Ø—Ä—Ç–≥—ç–≥–¥—Å—ç–Ω –±–∞–π–≤–∞–ª 400 –±—É—Ü–∞–∞—Ö (—ç–Ω—ç —Ö—ç–≤—ç—ç—Ä “Ø–ª–¥—ç–Ω—ç).

–ì—ç—Ö–¥—ç—ç client —Ç–∞–ª–¥ –∞–ª—å —Ö—ç–¥–∏–π–Ω –∑”©–≤ list —à“Ø“Ø–∂ –≥–∞—Ä–≥–∞–¥–∞–≥ –±–∞–π—Ö —ë—Å—Ç–æ–π ‚Äî –∏–Ω–≥—ç—Å–Ω—ç—ç—Ä 400 –≥–∞—Ä–∞—Ö–≥“Ø–π.

üíª Frontend logic update
1. List —à“Ø“Ø–ª—Ç“Ø“Ø—Ä –∑”©–≤ –∞–∂–∏–ª–ª—É—É–ª–∞—Ö

–¢–æ–≥–ª–æ–≥—á–¥—ã–≥ —Ç–∞—Ç–∞—Ö “Ø–µ–¥ (/api/registrations?tournamentId=...) –¥–∞—Ä–∞–∞—Ö –±–∞–π–¥–ª–∞–∞—Ä client –¥—ç—ç—Ä —à“Ø“Ø–Ω—ç:

const filteredPlayers = allPlayers.filter(p => {
  const registrations = p.registrations || [];
  const registeredEvents = registrations.map(r => JSON.parse(r.category).subType || JSON.parse(r.category).type);

  // –¢—É—Ö–∞–π–Ω “Ø“Ø—Å–≥—ç—Ö –≥—ç–∂ –±—É–π —Ç”©—Ä–ª–∏–π–Ω –¥–∞–≥—É—É —à“Ø“Ø—Ö
  if (categoryType === 'MEN_DOUBLES') return registeredEvents.some(e => e.includes('MEN_DOUBLES'));
  if (categoryType === 'WOMEN_DOUBLES') return registeredEvents.some(e => e.includes('WOMEN_DOUBLES'));
  if (categoryType === 'MIXED_DOUBLES') return registeredEvents.some(e => e.includes('MIXED_DOUBLES'));
  if (categoryType.includes('TEAM')) return registeredEvents.some(e => e.includes('TEAM'));
  return false;
});


‚úÖ –ò–Ω–≥—ç—Å–Ω—ç—ç—Ä ‚Äú–î–∞–Ω —ç—Ä—ç–≥—Ç—ç–π —Ö–æ—Å‚Äù —Å–æ–Ω–≥–æ—Å–æ–Ω “Ø–µ–¥ –∑”©–≤—Ö”©–Ω —Ç—ç—Ä —Ç”©—Ä”©–ª–¥ –±“Ø—Ä—Ç–≥“Ø“Ø–ª—Å—ç–Ω —ç—Ä—ç–≥—Ç—ç–π —Ç–æ–≥–ª–æ–≥—á–∏–¥ –ª list-–¥ –≥–∞—Ä–Ω–∞.

2. ”®”©—Ä–∏–π–Ω –Ω—ç—Ä–∏–π–≥ list-–¥ —Ö–∞—Ä—É—É–ª–∞—Ö–≥“Ø–π
const availablePlayers = filteredPlayers.filter(p => p.id !== currentUser.id);

3. –ë–∞–≥–∏–π–Ω –≥–∏—à“Ø“Ø–¥–∏–π–Ω —Ç–æ–æ–Ω—ã —Ö—è–∑–≥–∞–∞—Ä

UI –¥—ç—ç—Ä:

const minMembers = categoryType.includes('TEAM') ? 3 : 2;
const maxMembers = categoryType.includes('TEAM') ? 4 : 2;


Add —Ç–æ–≤—á –¥–∞—Ä–∞—Ö–∞–¥:

if (selectedMembers.length >= maxMembers) {
  toast.error(`–ë–∞–≥–∏–π–Ω –≥–∏—à“Ø“Ø–¥–∏–π–Ω –¥—ç—ç–¥ —Ö—è–∑–≥–∞–∞—Ä ${maxMembers}`);
  return;
}


API-–¥ –∏–ª–≥—ç—ç—Ö—ç—ç—Å ”©–º–Ω”© –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö:

if (selectedMembers.length < minMembers || selectedMembers.length > maxMembers) {
  toast.error(`–ë–∞–≥–∏–π–Ω –≥–∏—à“Ø“Ø–¥ ${minMembers}-${maxMembers} —Ö“Ø–Ω –±–∞–π—Ö —ë—Å—Ç–æ–π`);
  return;
}

4. –°–æ–Ω–≥–æ—Å–æ–Ω —Ç–æ–≥–ª–æ–≥—á–¥—ã–≥ —É—Å—Ç–≥–∞—Ö, —Å–æ–ª–∏—Ö UI –Ω—ç–º—ç—Ö

Selected Members —Ö—ç—Å—ç–≥—Ç:

<div className="flex flex-wrap gap-3 mt-4">
  {selectedMembers.map(member => (
    <div key={member.id} className="flex items-center gap-2 bg-green-100 rounded-lg px-3 py-2">
      <span>{member.name}</span>
      <button
        onClick={() => setSelectedMembers(prev => prev.filter(m => m.id !== member.id))}
        className="text-red-500 hover:text-red-700 text-sm"
      >
        ‚úï
      </button>
    </div>
  ))}
</div>


‚úÖ –≠–Ω—ç —Ç–æ–≤—á–æ–æ—Ä –±–∞–≥–∏–π–Ω –≥–∏—à“Ø“Ø–Ω–∏–π–≥ —Å–æ–ª–∏—Ö –±—É—é—É —É—Å—Ç–≥–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π –±–æ–ª–Ω–æ.

5. Team / Pair “Ø“Ø—Å–≥—ç—Ö –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç

–ò–ª–≥—ç—ç—Ö —Ñ—É–Ω–∫—Ü:

const handleSubmit = async () => {
  const payload = {
    tournamentId,
    category,
    memberIds: selectedMembers.map(m => m.id),
  };

  if (selectedMembers.length < minMembers || selectedMembers.length > maxMembers) {
    toast.error(`–ì–∏—à“Ø“Ø–¥–∏–π–Ω —Ç–æ–æ ${minMembers}-${maxMembers} –±–∞–π—Ö —ë—Å—Ç–æ–π`);
    return;
  }

  const res = await fetch(`/api/${isTeam ? 'teams' : 'pairs'}`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    credentials: 'include',
    body: JSON.stringify(payload),
  });

  if (!res.ok) {
    const err = await res.json();
    toast.error(err.message || '–ë“Ø—Ä—Ç–≥—ç–ª –±–∞—Ç–∞–ª–≥–∞–∞–∂—Å–∞–Ω–≥“Ø–π');
  } else {
    toast.success(`${isTeam ? '–ë–∞–≥' : '–•–æ—Å'} –∞–º–∂–∏–ª—Ç—Ç–∞–π –±“Ø—Ä–¥–ª—ç—ç!`);
    router.push(`/tournament/${tournamentId}/confirmation`);
  }
};